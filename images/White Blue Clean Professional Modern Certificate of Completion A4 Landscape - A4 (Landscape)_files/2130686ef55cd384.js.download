(globalThis["webpackChunk_canva_web"] = globalThis["webpackChunk_canva_web"] || []).push([[64113],{

/***/ 241205:
function(_, __, __webpack_require__) {__webpack_require__.n_x = __webpack_require__.n;const __web_req__ = __webpack_require__;__web_req__(905716);__web_req__(777395);__web_req__(726674);__web_req__(25361);__web_req__(79343);__web_req__(695227);__web_req__(728159);__web_req__(986461);__web_req__(932178);__web_req__(154798);__web_req__(529225);globalThis._5f74ec40302898c5a55451c9fbd04240 = globalThis._5f74ec40302898c5a55451c9fbd04240 || {};(function(__c) {var WNm=__c.WNm;var M=__c.M;var BO=__c.BO;var Ccp,Dcp,Ecp,Fcp,Gcp,Hcp,Ycp;Ccp=function(a,b){a.xa.track(Bcp,{...b,source:a.source,ha:a.ha})};Dcp=async function(a){const b=(0,__c.UNm)()();try{if(a.cJa!=null){var {ina:c}=b.r(await b.s(a.cJa.L_f(new __c.zCd)));if(c!=null&&c.length===0)a.errorService.error(Error("Failed to fetch partnerId"),{Ea:"PaymentPresenter: empty string partnerId"});else return c}}finally{b.s()}};
Ecp=function(a,b){if(a.Tf.N_a!==void 0){var c=a.Tf.Gwf.O8e,d=a.Tf.Gwf.P8e,e=a.Tf.T1e.z8e,f=a.Tf.T1e.A8e;if(c||d||e||f){var g=a.Tf.Z0a.a2f,h=a.Tf.Z0a.K8e,k=a.Tf.Z0a.b2f,l=a.Tf.Z0a.soe,n=a.Tf.Ueh||h;(["save_as_image","clipboard_web"].includes(b.gz)||n)&&Ccp(a.N,{EOc:"flow_start",nW:a.nW,endpoint:b.gz,O8e:c,P8e:d,z8e:e,A8e:f,a2f:g,K8e:h,b2f:k,soe:l})}}};
Fcp=function(a,b){b.YFl=(0,__c.kOm)(()=>a.Tf.status===2,c=>{c&&(Ecp(a,b),b.oQi||(b.oQi=(0,__c.kOm)(()=>a.Tf.Ueh,()=>{Ecp(a,b)})))},{fireImmediately:!0});b.eVl=(0,__c.kOm)(()=>a.Tf.status===2&&a.Tf.VK,c=>{if(c){var d=a.N;c=d.client.xa;var e=c.l4;d=__c.yg({endpoint:b.gz,source:d.source,document_id:d.ha});e.call(c,"publish_payment_form_loaded",d)}},{fireImmediately:!0})};
Gcp=function(a,b){if(a.Tf.N_a!==void 0){var c=a.Tf.Gwf.O8e,d=a.Tf.Gwf.P8e,e=a.Tf.T1e.z8e,f=a.Tf.T1e.A8e;(c||d||e||f)&&Ccp(a.N,{EOc:"continue_clicked",nW:a.nW,endpoint:b.gz,O8e:c,P8e:d,z8e:e,A8e:f,a2f:a.Tf.Z0a.a2f,K8e:a.Tf.Z0a.K8e,b2f:a.Tf.Z0a.b2f,soe:a.Tf.Z0a.soe})}};
Hcp=async function(a,b,c,d,e){const f=(0,__c.gOm)()();try{const g=e?.isRecording()?a.P.startSpan("submit_media_license_payment",e):a.P.kb("submit_media_license_payment",{yb:{name:"ui.publish_menu.media_payment.submit_media_license_payment"}}),h=b.$Bt;try{a.Y$l(b,0);if(!f.r(await f.s(a.FM.zlf(d)))){g.setStatus("error");return}if(!f.r(await f.s(a.FM.Vuc({items:a.Tf.ZGh,Is:a.Tf.Is},d,2,g,b.U9g)))){if(a.FM.status===3)return;g.setStatus("error");a.errorService.error(Error("Failed to submit media license payment"),
{extra:new Map([["error","invalid paymentResult"],["paymentStatus",a.FM.status.toString()],["invoiceError",a.FM.drb]])});return}f.r(await f.s(a.I1e()));f.r(await f.s(c({io:!1,PZd:!0,ub:()=>a.back(b,d)})))}catch(l){throw f.r(),g.setStatus("error"),a.errorService.error(Error("Failed to submit media license payment",{cause:l})),l;}finally{g.end(),a.Y$l(b,1)}const k=g.end().ki();if(h){const l=__c.pOm(h.Xf,h.Ye);a.N.H0h(h,l,k)}}finally{f.s()}};
__c.Jcp=function({soa:a,Bza:b,Gxc:c,sU:d,Xcd:e,hdd:f}){return(0,__c.vcp)(({Cwf:g,Mj:h,ub:k,onSubmit:l,kI:n,yDb:p,tA:q,Y_e:r,H5b:t,Mnc:u,sFc:w,dDi:x,Wyb:y,rNa:z,vLa:A})=>BO(Icp,{soa:a,Bza:b,Gxc:c,sU:d,Cwf:g,Mj:h,ub:k,onSubmit:l,kI:n,yDb:p,tA:q,Y_e:r,H5b:t,Mnc:u,sFc:w,Xcd:e,dDi:x,Wyb:y,tAa:__c.JJk,hdd:f,rNa:z,vLa:A}))};
__c.Tcp=function({y$h:a,Tf:b,oC:c,FM:d,xa:e,Ia:f,errorService:g,document:h,source:k,nW:l,XLa:n,YLa:p,L_a:q,hBk:r,qZg:t,rNa:u}){var w,x,y;e=new __c.oOm({xa:e,source:k,ha:h});f=f.Ed("ui.publish_menu.media_payment_flow");const z=new Kcp(d,b,e,f,g,n,p,q,l);let A;new (w=class extends Lcp{constructor(){super(A);x()}},(()=>{class C extends(y=Mcp){static G(D){M(D,{nR:Ncp,EE:Ncp})}componentDidMount(){Fcp(z,this.dKc);this.yDb()}componentWillUnmount(){var D=this.dKc;D.YFl!=null&&(D.YFl(),D.YFl=void 0);D.eVl!=
null&&(D.eVl(),D.eVl=void 0);D.oQi!=null&&(D.oQi(),D.oQi=void 0);this.yDb()}render(){return z.dLl?Ocp(__c.$D,{content:Ocp(__c.Yk,{tone:"critical",size:"small",children:z.errorMessage??__c.K("KY6JSA")})}):Ocp("div",{className:Pcp("NI0RPg",{Ecv4eQ:this.props.ije||this.props.C_e,P_KHmQ:this.props.wka===29||this.props.wka===17}),children:Ocp(c,{x8:this.x8,nR:this.nR,EE:this.EE,Bwf:this.dKc.page===1||this.dKc.page===3,ega:{soa:this.dKc.soa,Daa:this.Daa,ipa:this.props.wka,BVb:"invoke"}})})}get Daa(){const D=
this.dKc.page;switch(D){case 3:case 2:case 1:return 2;default:throw new __c.v(D);}}get nR(){var D=__c.AO([14]);if(this.props.ije)return new Set([...D,...__c.AO([8,6])]);if(this.props.C_e)return new Set([...D,...__c.AO([8,7])]);if(this.props.T_e)return new Set([...D,...__c.rcp.ioi]);D=__c.gcp(8);r&&(D=__c.gcp(1,D));t&&(D=[...(new Set([...__c.gcp(9,D),...__c.AO([10],D)]))]);return new Set(D)}get EE(){return{price:b.totalPrice,BPf:b.Tub,type:0}}constructor(...D){super(...D);this.dKc=(A.G(this),z.createStore(this.props.gz,
!!this.props.C_e||!!this.props.ije||!!this.props.T_e,this.props.ije||this.props.C_e||this.props.T_e?`mobile-${this.props.ije?"ios":"android"}-editor-2`:void 0));this.x8=Qcp(G=>{const J=this.dKc.Wul,L=this.dKc.page,N=this.dKc.X8n;return J===0&&G.Tec===!0||L===2?Ocp(a,{ub:this.props.t0a?void 0:()=>this.ub(G),onSubmit:()=>{Hcp(z,this.dKc,this.props.onComplete,G)},Cwf:this.props.Bqa,yDb:this.yDb,kI:P=>{P||this.ub(G)},tA:d.status===5||J===0&&N,Mj:G,Y_e:this.props.Y_e&&!this.props.T_e,H5b:this.props.H5b,
Mnc:this.props.Mnc,sFc:this.props.sFc,dDi:this.props.dDi,Wyb:this.props.Wyb,tAa:__c.JJk,rNa:u,vLa:async P=>{const Q=Rcp()();try{Q.r(await Q.s(b.vLa(P)))}finally{Q.s()}}}):Ocp(this.props.Xga,{kj:this.Kct,rJa:this.rJa,sJa:this.sJa,Mj:G,jAa:L===1?this.props.Ual??"settings":"upsell",doa:this.props.doa,X4m:N&&G.$l!=null&&(b.status===2&&this.EE.type===0?this.EE.BPf:void 0)===0})});this.yDb=()=>d.yDb();this.rJa=(G,J)=>{J&&b.Jpa(G,{N_a:this.props.N_a})};this.sJa=G=>{b.GUa(G)};this.ub=G=>{this.yDb();z.back(this.dKc,
G)};this.Kct=(G,J,L)=>z.Rri(this.dKc,this.props.onComplete,G,J,L)}}({c:[A,x]}=Scp(C,[],[__c.Nb],y))})(),w);return A};__c.Vcp=function({Tf:a}){return Qcp(b=>Ocp(Ucp,{Tf:a,kI:b.kI,Mj:b.Mj,gWc:b.gWc,Rub:b.Rub,jLd:b.jLd}))};__c.$cp=function({aa:a,errorService:b,zd:c,yd:d,xa:e,cJa:f}){e=new __c.Acp(e);a=new Wcp(b.fg("presenter"),c.currency,d,a.wb.brand.id,a.user.id,e,f);b=new Xcp;return{Gxc:Ycp({ftt:b}),FM:new Zcp(b,a)}};
Ycp=function({ftt:a}){return Qcp(b=>Ocp(adp,{gg:b.gg,zZm:!!b.tA,Bia:!!b.tA,drb:a.drb,tA:!!b.tA,ub:b.ub,onSubmit:b.onSubmit,Cwf:b.Cwf,Mj:b.Mj,nZc:b.nZc,ckp:b.ckp}))};__c.zcp.prototype.T0h=__c.fa(1254,function(a){this.xa.l4("payment_form_submit_clicked",__c.yg({form:a.form,payment_provider:a.RRa}))});__c.Acp.prototype.T0h=__c.fa(1253,function({form:a,qXe:b,HI:c,paymentMethod:d}){this.client.T0h({form:__c.ycp[a],RRa:this.N6e({qXe:b,HI:c,paymentMethod:d})})});
__c.nOm.prototype.H0h=__c.fa(1178,function(a){this.xa.l4("publish_pay_publish_clicked",__c.yg({endpoint:a.endpoint,source:a.source,document_id:a.ha,custom_range:a.Ovk,view_type:a.cX,autoplay_timing:a.aPq,transition_style:a.Rpu,web_style:a.fAu,file_type:a.fileType,format:a.format,style:a.style,limit_message_displayed:a.Tdo,refs:a.refs,license_types:a.Pml,message:a.message,compressed:a.SSg,size_changed:a.svf,is_in_app_payment:a.WKv,selected_payment_method:a.$l,is_combined_image:a.TO,is_pdf_password_protected:a.ZWb}))});
__c.oOm.prototype.H0h=__c.fa(1177,function(a,b,c){const {endpoint:d,formData:e={}}=a;this.client.H0h({endpoint:d,Ovk:b,source:this.source,ha:this.ha,Gb:c,...e})});
var Bcp={eventType:"experiment_clamp_enrolled",La(a){return __c.yg({source:a.source,document_id:a.ha,endpoint:a.endpoint,trigger_type:a.EOc,is_design_owner:a.nW,has_subscription_based_medias:a.O8e,has_subscription_based_videos:a.P8e,has_excluded_subscription_based_medias:a.z8e,has_excluded_subscription_based_videos:a.A8e,has_paid_medias:a.a2f,has_paid_fonts:a.K8e,has_paid_videos:a.b2f,has_paid_audios:a.soe})}},Xcp=class{static G(a){M(a,{status:__c.XNm.ref,drb:__c.XNm.ref})}constructor(){this.status=
(Xcp.G(this),1)}},Wcp=class{static G(a){M(a,{yDb:__c.YNm,Vuc:__c.YNm})}async zlf(a,b){const c=(0,__c.UNm)()();try{this.yDb(a);try{const d=__c.m(b.vv,"paymentApi must be defined on paymentFormSubmitted"),e=c.r(await c.s(d.Ei()));return e.responseType===2?(WNm(()=>{a.drb=e.message;a.status=6}),!1):!0}catch(d){throw c.r(),WNm(()=>{a.drb=__c.I("ZBkUXQ",[__c.ZNm]);a.status=6}),this.errorService.na(d,{Ea:"PaymentPresenter: unexpected submitPayment error:"}),d;}}finally{c.s()}}async phj(a){const b=(0,__c.UNm)()();
try{const c=__c.m(a.vv,"paymentApi must be defined on paymentCancelled");b.r(await b.s(c.cancel()))}finally{b.s()}}async Vuc(a,b,c,d,e,f){const g=(0,__c.UNm)()();try{if(a.status===5)return!1;a.drb=void 0;a.status=5;const h=__c.m(c.vv,"paymentApi must be defined on submitPayment");if(b.items.length===0)return g.r(await g.s(h.cancel({parentSpan:e}))),WNm(()=>{a.status=3}),!0;const k={qXe:c.Cw?.HI?.details.type==="CREDIT_CARD",HI:!!c.Cw?.HI&&c.Cw?.HI?.details.type!=="CREDIT_CARD",form:d,paymentMethod:c.$l};
try{this.Oye.T0h(k);const l=g.r(await g.s(Dcp(this))),{Le:n,error:p}=g.r(await g.s(this.yd.Ysi(new __c.rIm({body:{Hhn:{brand:this.brand,user:this.user},items:b.items,currency:this.currency,Ihn:{U9g:f??"editor-2",Ry:l},billingAddress:h.kW(),XPl:void 0,eZ:void 0,bkp:!1,MNo:{dueDate:void 0,TYr:2}}}))));if(!n)return WNm(()=>{a.drb=__c.m(p,"createInvoiceV2 should return an error object when invoice creation fails").message;a.status=6}),this.Oye.$5d(k),g.r(await g.s(h.cancel({parentSpan:e}))),!1;const q=
g.r(await g.s(h.Rt({Le:n,S2:!1,vD:void 0,subscription:void 0,parentSpan:e})));switch(q.responseType){case 1:return WNm(()=>{a.status=3}),!0;case 2:if([11,12,5,1].includes(q.paymentMethod)&&[35,39].includes(q.code))return WNm(()=>{a.status=3}),!1;WNm(()=>{a.drb=q.message;a.status=6});this.Oye.$5d(k);return!1;default:throw new __c.v(q);}}catch(l){throw g.r(),l instanceof __c.PHa&&this.errorService.error(l,{Ea:"PaymentPresenter: Unexpected HttpServiceUnavailableError:"}),WNm(()=>{a.drb=__c.I("ZBkUXQ",
[__c.ZNm]);a.status=6}),h.cancel({hkc:!0,parentSpan:e}),this.Oye.$5d(k),this.errorService.na(l,{Ea:"PaymentPresenter: unexpected submitPayment error:"}),l;}}finally{g.s()}}constructor(a,b,c,d,e,f,g){this.errorService=a;this.currency=b;this.yd=c;this.brand=d;this.user=e;this.Oye=f;this.cJa=g;this.yDb=(Wcp.G(this),h=>{h.drb=void 0;h.status=1})}},bdp=class{static G(a){M(a,{Gac:__c.lOm.deep,Wul:__c.lOm.ref,page:__c.iOm})}get page(){return this.Gac[this.Gac.length-1]}get soa(){switch(this.page){case 2:case 1:case 3:return 2;
default:throw new __c.v(this.page);}}constructor(a,b,c){this.gz=a;this.X8n=b;this.U9g=c;this.Gac=(bdp.G(this),[1]);this.Wul=1}},Kcp=class{static G(a){M(a,{dLl:__c.iOm,E9f:__c.iOm,errorMessage:__c.iOm,Rri:__c.mOm,back:__c.mOm,Y$l:__c.mOm})}createStore(a,b,c){return new bdp(a,b,c)}get dLl(){return this.FM.status===4||this.Tf.status===3}get E9f(){return this.dLl||this.Tf.status===4}get errorMessage(){return this.Tf.errorMessage}async Rri(a,b,c,d,{io:e=!1,C_a:f=!1,kjn:g,doa:h}={}){const k=(0,__c.gOm)()();
try{const l=this.P.kb("click_publish_continue",{yb:{name:"ui.publish_menu.media_payment.click_publish_continue"}});a.$Bt=d;const n=this.Tf.ZGh,p=this.Tf.VK,q=this.Tf.Tub,r=__c.pOm(d.Xf,d.Ye),t=a.X8n&&c.$l!=null&&q===0,u=c.$l===7&&!c.Cw?.hmr&&c.Cw?.HI?.details.type!=="EBANX_NUPAY"||c.$l===2;e||n.length===0?(k.r(await k.s(b({io:e,PZd:!1,ub:()=>this.back(a,c)}))),Gcp(this,a),this.Wyf(d,n.length>0,e,l,r)):!p||g!=="settings"&&u&&!f||t?(c.dSb?.I0h(),k.r(await k.s(Hcp(this,a,b,c,l))),l.end()):(g&&a.page===
1&&h!=="settings"?(0,__c.jOm)(()=>a.Gac.push(3)):((0,__c.jOm)(()=>a.Gac.push(2)),c.dSb?.I0h()),Gcp(this,a),this.Wyf(d,!0,e,l,r))}finally{k.s()}}Wyf(a,b,c,d,e){d.gb().addEvent("evaluated");const f=[a,b,c,e];d.gb().Wj(({ki:g})=>{this.N.Wyf(...f,g())});setTimeout(__c.fOm.wrap(()=>{d.gb().addEvent("rendered");d.end()}))}async I1e(){const a=(0,__c.gOm)()();try{const b=this.Tf.Ykb.reduce((c,d)=>{__c.mbk(d,e=>c.media.push({id:e.mediaId,version:e.KA}),()=>{},e=>c.video.push(e.videoId),e=>c.audio.push(e.audioId));
return c},{media:[],video:[],audio:[]});a.r(await a.s(Promise.all([this.Tf.Jpa(),this.XLa?.(b.media),this.YLa?.(b.video),this.L_a?.(b.audio)])))}finally{a.s()}}back(a,b){a.Gac.length>1&&a.Gac.pop();b.$_({C_a:a.page===2})}Y$l(a,b){a.Wul=b}constructor(a,b,c,d,e,f,g,h,k){this.FM=a;this.Tf=b;this.N=c;this.P=d;this.errorService=e;this.XLa=f;this.YLa=g;this.L_a=h;this.nW=k;Kcp.G(this)}},Icp=class extends __c.wcp{get QVi(){return __c.SNm(this.props.Mj.$l)}componentDidMount(){if(this.props.tAa){var a=b=>
{this.props.vLa&&this.props.vLa(b)};this.unsubscribe=this.props.rNa?.(a)}}componentWillUnmount(){this.unsubscribe?.()}render(){return BO(__c.cF,{onSubmit:this.props.onSubmit,content:this.content,footer:this.footer})}get footer(){const a=this.props.Gxc,b=this.props.sU,c=this.props.Mj,d=this.props.tA,e=this.props.kI,f=this.props.Mnc,g=this.props.hdd,h=this.props.tAa;return(0,__c.ucp)("span",{children:[!this.props.sFc&&BO(c.x9a,{}),h&&!this.QVi&&g&&BO(__c.O,{xc:"1u",children:BO(g,{Npa:c.Cw?.Npa??0,i_a:(c.i_a&&
c.kD?.type==="SPLIT"&&c.kD.gBc>0)??!1})}),BO("div",{className:"_0SMzow",children:BO(a,{Cwf:this.props.Cwf,ub:this.props.ub,onSubmit:this.props.onSubmit,Mj:c,tA:d,nZc:this.props.Wyb})}),!f&&(!h||this.QVi)&&BO("div",{className:"cAC1lg",children:BO(b,{Mj:c,kI:e})})]})}get content(){const a=this.props.Bza,b=this.props.Mj,c=this.props.H5b,d=this.props.Y_e,e=this.props.Xcd,f=this.props.dDi,g=this.props.Wyb,h=this.props.tAa;return(0,__c.ucp)(__c.tcp,{children:[BO(b.C3a,{Rud:2}),(!h||this.QVi)&&BO(a,{jjl:!0,
ZZg:c}),!!d&&(!h||this.QVi)&&BO(__c.PNm,{EHb:b.Cw?.Npa,loading:b.formState!==4,padding:"top"}),BO(b.Tvb,{type:"checkbox",STd:0,jLd:h}),BO(b.PTa,{Rub:"small",Wyb:g,Rsb:(0,__c.ucp)(__c.tcp,{children:[BO(b.PJ,{Rub:"medium",QW:!1}),BO(b.NFb,{}),BO(b.PaymentOptions,{Rub:"small"}),e!=null&&!!f&&BO(e,{})]})})]})}},Rcp=__webpack_require__(75402)._;var cdp=__webpack_require__(296713),Ocp=cdp.jsx,ddp=cdp.jsxs;var edp=__webpack_require__,fdp=edp(208463),Pcp=edp.n_x(fdp)();var Qcp=__webpack_require__(270531).PA;var gdp=__webpack_require__(978109),Mcp=gdp.Component,hdp=gdp.createRef,idp=gdp.PureComponent;var Lcp=__webpack_require__(277049)._;var jdp=__webpack_require__(186901),Ncp=jdp.EW,kdp=jdp.XI;var Scp=__webpack_require__(269018)._;var Ucp=class extends Mcp{render(){const {Tf:a,Mj:{OTa:b},gWc:c,SDv:d,Rub:e="small",jLd:f=!1}=this.props;return a.Uk!=null&&a.Uk.length>0||d?Ocp("div",{className:Pcp("_2mEe_g JYIidw",{tBiCZQ:e==="small"}),children:Ocp(b,{type:"minimalFooter",Rub:"small",DLq:e!=="none",kI:this.kI,gWc:c,jLd:f})}):null}constructor(...a){super(...a);this.kI=b=>{this.props.kI?.(b)}}};var adp=class extends idp{componentDidMount(){this.props.ckp&&this.Fj.current?.focus()}render(){var a=this.psh();var b=this.props.tA;const c=this.props.Mj.formState===5||this.props.Mj.formState===6||this.props.zZm,d=this.props.Mj.formState===7||this.props.Bia;b=ddp("div",{className:"JvM0nQ",children:[this.props.ub&&Ocp(__c.td,{variant:"secondary",className:"dsGnJg",disabled:c,form:this.props.gg,type:"button",onClick:this.ub,ariaLabel:__c.K("o6uJ3w"),children:Ocp(__c.oq,{size:"medium"})}),Ocp(this.props.Mj.dfa,
{ref:this.Fj,disabled:d,form:this.props.gg,type:"submit",onClick:this.onSubmit,loading:b,className:"JqaGoA",srr:!0,nZc:this.props.nZc,children:this.props.Cwf})]});return ddp("fieldset",{className:"Ag4Yww",children:[a,b]})}psh(){const a=this.props.drb;if(a)return Ocp("div",{className:"Nks59w",children:Ocp(__c.Yk,{tone:"critical",children:Ocp(__c.Xj,{message:a})})})}constructor(...a){super(...a);this.Fj=hdp();this.ub=b=>{this.props.ub&&(b.preventDefault(),this.props.ub())};this.onSubmit=b=>{this.props.onSubmit&&
(b.preventDefault(),this.props.onSubmit())}}};var Zcp=class{static G(a){M(a,{setStatus:kdp})}get currency(){return this.L.currency}get status(){return this.store.status}setStatus(a){this.store.status=a}get drb(){return this.store.drb}phj(a){return this.L.phj(a)}zlf(a){return this.L.zlf(this.store,a)}Vuc(a,b,c,d,e){return this.L.Vuc(this.store,a,b,c,d,e)}yDb(){this.L.yDb(this.store)}constructor(a,b){this.store=a;this.L=b;Zcp.G(this)}};
}).call(globalThis, globalThis._5f74ec40302898c5a55451c9fbd04240);}

}])
//# sourceMappingURL=sourcemaps/2130686ef55cd384.js.map